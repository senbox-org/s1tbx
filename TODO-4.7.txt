Reprojection:
=============

* Old org.esa.beam.framework.dataop.maptransf still heavily in use!
  Remove usage, deprecate and/or remove classes.
  ==> FINAL, ?, OPEN

Masks:
======

* Mask manager shall test for dependencies before deleting
  ==> FINAL, ?, OPEN


* We need a special mask type masking out no-data pixels. If no-data value
  is set, it shall be used in its raw form by the mask image (OpImage).
  If valid-expression is set, it shall be AND-ed with the no-data mask,
  if any.
  ==> FINAL (v4.8), ?, OPEN
* We need a special mask type backed by a raster data buffer. Users shall
  be able to "paint" mask pixels (SYKE!). Also the "magic-stick" tool will #
  operate on such mask types. The raster data of the new mask type will need to
  be stored to disk.
  ==> FINAL (v4.8), ?, OPEN

VectorDataNode:
===============
* Create subset from Product with Pins, GCPs -> GCPs outside of subset bounds are preserved, pins are not
  Explain in help, that this is intended.
  ==> FINAL, ?, OPEN
* Vector data node I/O shall encode/decode delimiter characters occurring in text converted from objects.
  ==> FINAL, ?, OPEN
* Pin & GCP Vector Data Nodes shall not be visible as long as there are no pins / GCPs
  added to the product
  ==> FINAL, ?, OPEN
* Use SLD from shapefile for styling figures
  ==> FINAL, MZ, OPEN (ongoing)
* Export vector data node to shapefile
  ==> FINAL, ?, OPEN (may exist: look into shapefile editor demo)
* Import of Geometry does not work when shapefile has no CRS and shapefile coordinates are not in WGS84.
  Explain in help, that this is intended. (better option would be to prompt the user to enter a CRS).
  ==> FINAL, ?, OPEN (see issue in Reprojection)
* "Profile plot" and "Coordinate List", are not updated when figure selection changes
  ==> FINAL, MP, OPEN (REOPEN by OF)
* When reprojecting (subsetting?) products, we must also transform geometry and
  align CRS of feature collections in vector data nodes!!! Use FeatureCollectionClipper
  in ShapefileLayer code. Pins/GCPs need special treatment!
  Done (MZ), but this does not work when prod. will be saved/exported, than opened in VISAT and reproj. (OF)
  ==> FINAL, MZ, OPEN (REOPEN by OF)

Figures:
========
* Select-tool shall auto-select layer containing a clicked figure
  ==> FINAL, NF, OPEN
* Deprecate or even completely remove ald Figure + Tool classes
  ==> FINAL, ?, OPEN
* Still can't rotate figures.
  ==> FINAL, NF, OPEN
* Number of created vertex handles should be dependent on current viewport
  ==> FINAL, NF, OPEN
* Still can not add/remove geometry vertices
  ==> FINAL, NF, OPEN
* Still cannot draw true circles/squares and also adjust lines and points on grid.
  ==> FINAL, ?, OPEN
* Layer style editor doesn't work anymore
  ==> FINAL, MP, OPEN
* New edit menu:
  - Test Cut/Copy/Paste!
  - What about Undo/Redo?!? (should work!)
  - After Paste: select inserted figures and displace a few (view) pixels
  ==> FINAL, ?, OPEN
* Allow for geometric operations on geometries: add/sub/intersection (JTS!)
  ==> FINAL, ?, OPEN


Product tree:
=============
* Don't display empty groups
  ==> FINAL, ?, OPEN

Layers:
=======
* We once decided that we wanted to introduce static factory methods for each(!) layer type
  following the JAI-Descriptor concept. Nothing done so far.
  ==> FINAL, ?, OPEN
* Deprecate and/or remove old Layer class code
  ==> FINAL, ?, OPEN
* Don't use class names e.g. in Session I/O.
  ==> FINAL, ?, OPEN


GPF Processors:
===============

* Need file and help menu items as in "old" processors
  ==> FINAL, ?, OPEN
* Need minimal developer guide  
  ==> FINAL, ?, OPEN
* Important issues with the band's source image:
  - dispose() method on MultiLevelImage shall not null its product node,
    use WeakReference instead.
  - Don't dispose source MultiLevelImage, if the RasterDataNode is not the
    owner, e.g. flag RasterDataNode.isSourceImageOwner()
  ==> FINAL, ?, OPEN
* Done, enable/harmonise geo-coding transfer in all GPF ops  (see BEAM-1047 and BEAM-1050)
  Changelog needs update.
  ==> FINAL, MP, OPEN


SMOS-Box:
=========
* Create add on installer
  ==> FINAL, RQ, OPEN
* Support missing 2 aux products
  ==> FINAL, RQ, OPEN
* Speed up statistics
  ==> FINAL, RQ, OPEN
* We need the RasterDataNode.areaOfInterest:Geometry new property for boosting
  statistics computation and possibly also display. This property is optional but
  some product readers may set it, e.g. SMOS reader. Tile bounds can easily be
  tested for intersection with areaOfInterest and possibly ignored.
  Also very important for SMOS-Box 2.0.1
  ==> FINAL, *, OPEN

GlobToolbox
===========
* Create add on installer
  ==> FINAL, MP, OPEN

CHRIS-GeoCorrection
===================
* Auto-Download Telemetry
  ==> FINAL, RQ, OPEN
* NullPointerException after map-projection if not saved to file
  ==> FINAL, RQ, OPEN

Envisat Reprocessing 3:
=======================
* Format update
  ==> FINAL (v4.7.x), *, OPEN

Other BEAM/VISAT/API Stuff:
===========================
* Rename 'Pin' into 'Placemark'
  ==> FINAL, NF, OPEN
* Auto-insert BlueMarble (if WSG-84 lat/lon) and Country shapes
  ==> FINAL, *, OPEN
* Avoid adding too much node listeners to a product:
  - abstract ProductNode.handleRename(node, oldName, newName)
  - abstract ProductNode.handleNodeDataChanged(node, oldName, newName)
  ==> FINAL, *, OPEN
* Move PropertyPane and dependency to TableLayout into Ceres
  ==> FINAL, *, OPEN

#################################################################
SMOS-box Tests results
#################################################################
1) PIN selection  does not work:
   create PIN
   select 'Snap to selected PIN' in SMOS L1C Chart
                                    SMOS L1C Flag-Matrix
                                    SMOS L1C Table

   --> no data wil be displayed                                 

---------------------------------------------------------------
2) Warning "Illegal element 'imageToModelTransform'" by open session

open session
-->
VISAT-Warning: " The following problen(s) occured:
Illegal element 'imageToModelTransform'

Session will be opened

------------------------------------------------------------------
3) no reader for
SM_OPER_AUX_VTEC_R

#################################################################
VISAT GUI Tests results
#################################################################

VISAT does not know about existing colour of geometries

a) colour:
   create geometry-1 -> e.g. it is blue
   reproject product
   create geometry-2 in the reprojection
   --> it will be blue, just like the geometry-1

-------------------------------------------------------------------

geometry will be deselected as roi by reprojection:

create geometry --> will be roi automatically
reprojectin --> geometry will be no more roi
(CAN_NOT_REPRODUCE, MZ, 2010-01-27)
-------------------------------------------------------------------

pixel info view disrerads selected PIN:

create some PINs
open Pixel Info view
select 'Snap to selected PIN'
select one Pin, than other ...
-->
Pixel Info view will not be updated

-------------------------------------------------------------------

Spectrum window will not be updated when you create some PINs and than open Spectrum window:

open image view
create some PINs
open Spectrum
-->
   'Show spectra for selected (all) pins' are disabled

(note:
1) if you click one of enabled buttons
   --> 'Show spectra for selected (all) pins' will be enabled
2) if you foremost open Spectrum window and than create some PINs
   --> 'Show spectra for selected (all) pins' will be enabled)

--------------------------------------------------------------------

?is it OK? :
open image view
create some gcps
make subset from view
->
subset product contains GCPs out of subset product boundary
---------------------------------------------------------------------
geometry contains holes (Löcher)
make subset from view
->
geometry in the subset product will be empty
---------------------------------------------------------------------
PIN, GCP Manager. Updating problems:

set PINs or open dimap produkt, containing PINs/GCPs
open PIN/GCP Manager
Select PIN/GCP in the table
->
delete, edit und export buttons are disabled
---------------------------------------------------------------------
import Pin(s) / create /update Pin(s) using PIN Manager
->
Pin will be set wrong (outside of the product boundary)
---------------------------------------------------------------------
DONE: "Profile plot" and "Coordinate List" are be updated not correctly
REOPEN:
- "Profile plot" and "Coordinate List" are not updated when figure selection changes:
create 2 geometries geometry_1 and geometry_2
select geometry_1 --> "Co-ordinate list not available.
No geometry (line, polyline or polygon) selected in the image view."
- "Profile plot" and "Coordinate List" are not updated correctly when draw a figure in reproj. product

-------------------------------------------------------------------------------------

import Spatial subset from PRISM data (PSM_O1B2R)
VOL-ALPSMF019892665-O1B2R_UF

or

Product Grabber
open dir containing this PRISM data

java.lang.IllegalStateException: org.opengis.referencing.operation.OperationNotFoundException: Bursa wolf parameters required.
	at org.esa.beam.util.FeatureCollectionClipper.getTransform(FeatureCollectionClipper.java:125)
	at org.esa.beam.util.ProductUtils.copyVectorData(ProductUtils.java:1433)
	at org.esa.beam.framework.dataio.ProductSubsetBuilder.createProduct(ProductSubsetBuilder.java:339)
	at org.esa.beam.framework.dataio.ProductSubsetBuilder.readProductNodesImpl(ProductSubsetBuilder.java:95)
	at org.esa.beam.framework.dataio.AbstractProductReader.readProductNodes(AbstractProductReader.java:159)
	at org.esa.beam.framework.dataio.AbstractProductBuilder.readProductNodes(AbstractProductBuilder.java:72)
	at org.esa.beam.framework.dataio.ProductSubsetBuilder.createProductSubset(ProductSubsetBuilder.java:70)

(
	at org.esa.beam.framework.ui.NewProductDialog.onOK(NewProductDialog.java:168)
	at org.esa.beam.framework.ui.AbstractDialog$3.actionPerformed(AbstractDialog.java:423)
	at javax.swing.AbstractButton.fireActionPerformed(AbstractButton.java:1995)
	at javax.swing.AbstractButton$Handler.actionPerformed(AbstractButton.java:2318)
	at javax.swing.DefaultButtonModel.fireActionPerformed(DefaultButtonModel.java:387)
    ...
 and for Product Grabber:

   	at org.esa.beam.framework.dataio.ProductSubsetBuilder.createProductSubset(ProductSubsetBuilder.java:64)
	at org.esa.beam.framework.datamodel.Product.createSubset(Product.java:1583)
	at org.esa.beam.visat.actions.pgrab.model.dataprovider.QuicklookProvider.createQuickLook(QuicklookProvider.java:110)
	at org.esa.beam.visat.actions.pgrab.model.dataprovider.QuicklookProvider.createData(QuicklookProvider.java:65)
	at org.esa.beam.visat.actions.pgrab.model.RepositoryManager$UpdateProcess.doInBackground(RepositoryManager.java:315)
	at org.esa.beam.visat.actions.pgrab.model.RepositoryManager$UpdateProcess.doInBackground(RepositoryManager.java:224)
	at javax.swing.SwingWorker$1.call(SwingWorker.java:278)
	at java.util.concurrent.FutureTask$Sync.innerRun(FutureTask.java:303)
	at java.util.concurrent.FutureTask.run(FutureTask.java:138)
	at javax.swing.SwingWorker.run(SwingWorker.java:317)
	at java.util.concurrent.ThreadPoolExecutor$Worker.runTask(ThreadPoolExecutor.java:886)
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:908)
	at java.lang.Thread.run(Thread.java:619)
)

Caused by: org.opengis.referencing.operation.OperationNotFoundException: Bursa wolf parameters required.
	at org.geotools.referencing.operation.DefaultCoordinateOperationFactory.createOperationStep(DefaultCoordinateOperationFactory.java:1072)
	at org.geotools.referencing.operation.DefaultCoordinateOperationFactory.createOperationStep(DefaultCoordinateOperationFactory.java:1136)
	at org.geotools.referencing.operation.DefaultCoordinateOperationFactory.createOperationStep(DefaultCoordinateOperationFactory.java:881)
	at org.geotools.referencing.operation.DefaultCoordinateOperationFactory.createOperationStep(DefaultCoordinateOperationFactory.java:965)
	at org.geotools.referencing.operation.DefaultCoordinateOperationFactory.createOperation(DefaultCoordinateOperationFactory.java:243)
	at org.geotools.referencing.operation.BufferedCoordinateOperationFactory.createOperation(BufferedCoordinateOperationFactory.java:254)
	at org.geotools.referencing.CRS.findMathTransform(CRS.java:1026)
	at org.geotools.referencing.CRS.findMathTransform(CRS.java:994)
	at org.esa.beam.util.FeatureCollectionClipper.getTransform(FeatureCollectionClipper.java:120)
	... 106 more
----------------------------------------------------------------------------

prod = A2004216092500.L2_LAC.x.hdf (OBPG, child)

import/export band subset (nLw_412 + flags)

Exception in thread "AWT-EventQueue-0" java.lang.NullPointerException
   at org.esa.beam.framework.dataio.ProductSubsetBuilder.readBandRasterDataImpl(ProductSubsetBuilder.java:134)
   at org.esa.beam.framework.dataio.AbstractProductReader.readBandRasterData(AbstractProductReader.java:240)
   at org.esa.beam.jai.BandOpImage.computeProductData(BandOpImage.java:37)
   at org.esa.beam.jai.RasterDataNodeOpImage.computeRect(RasterDataNodeOpImage.java:57)
   at javax.media.jai.SourcelessOpImage.computeTile(SourcelessOpImage.java:137)
   at com.sun.media.jai.util.SunTileScheduler.scheduleTile(SunTileScheduler.java:904)
   at javax.media.jai.OpImage.getTile(OpImage.java:1129)
   at com.bc.ceres.glevel.MultiLevelImage.getTile(MultiLevelImage.java:38)
   at com.sun.media.jai.opimage.CropOpImage.getTile(CropOpImage.java:122)
   at javax.media.jai.PlanarImage.cobbleFloat(PlanarImage.java:3254)
   at javax.media.jai.PlanarImage.getData(PlanarImage.java:2181)
   at javax.media.jai.RenderedOp.getData(RenderedOp.java:2276)
   at com.bc.ceres.glevel.MultiLevelImage.getData(MultiLevelImage.java:48)
   at org.esa.beam.framework.datamodel.Band.readRasterData(Band.java:336)
   at org.esa.beam.framework.datamodel.AbstractBand.readSubRegionRasterData(AbstractBand.java:776)
   at org.esa.beam.framework.datamodel.AbstractBand.readPixels(AbstractBand.java:235)
   at org.esa.beam.framework.datamodel.PixelGeoCoding$PixelGrid.create(PixelGeoCoding.java:803)
   at org.esa.beam.framework.datamodel.PixelGeoCoding$PixelGrid.access$000(PixelGeoCoding.java:772)
   at org.esa.beam.framework.datamodel.PixelGeoCoding.initData(PixelGeoCoding.java:144)
   at org.esa.beam.framework.datamodel.PixelGeoCoding.initialize(PixelGeoCoding.java:441)
   at org.esa.beam.framework.datamodel.PixelGeoCoding.getGeoPos(PixelGeoCoding.java:460)
   at org.esa.beam.framework.datamodel.Product.isCompatibleProduct(Product.java:1179)
   at org.esa.beam.util.ProductUtils.copyVectorData(ProductUtils.java:1408)
   at org.esa.beam.framework.dataio.ProductSubsetBuilder.createProduct(ProductSubsetBuilder.java:339)
   at org.esa.beam.framework.dataio.ProductSubsetBuilder.readProductNodesImpl(ProductSubsetBuilder.java:95)
   at org.esa.beam.framework.dataio.AbstractProductReader.readProductNodes(AbstractProductReader.java:159)
   at org.esa.beam.framework.dataio.AbstractProductBuilder.readProductNodes(AbstractProductBuilder.java:72)
   at org.esa.beam.framework.dataio.ProductSubsetBuilder.createProductSubset(ProductSubsetBuilder.java:70)

    .......... 
-------------------------------------------------------------------------------------
export DIMAP product when product contains PIN outside of boundary

Exception in thread "AWT-EventQueue-0" java.lang.NullPointerException
	at org.esa.beam.framework.dataio.ProductSubsetBuilder.copyPlacemarks(ProductSubsetBuilder.java:385)
	at org.esa.beam.framework.dataio.ProductSubsetBuilder.addPlacemarks(ProductSubsetBuilder.java:354)
	at org.esa.beam.framework.dataio.ProductSubsetBuilder.createProduct(ProductSubsetBuilder.java:345)
	at org.esa.beam.framework.dataio.ProductSubsetBuilder.readProductNodesImpl(ProductSubsetBuilder.java:95)
	at org.esa.beam.framework.dataio.AbstractProductReader.readProductNodes(AbstractProductReader.java:159)
	at org.esa.beam.framework.dataio.AbstractProductBuilder.readProductNodes(AbstractProductBuilder.java:72)
	at org.esa.beam.framework.dataio.ProductSubsetBuilder.createProductSubset(ProductSubsetBuilder.java:70)
	at org.esa.beam.framework.dataio.ProductSubsetBuilder.createProductSubset(ProductSubsetBuilder.java:64)
	at org.esa.beam.visat.actions.ProductExportAction.exportProduct(ProductExportAction.java:203)
	at org.esa.beam.visat.actions.ProductExportAction.actionPerformed(ProductExportAction.java:57)
	at org.esa.beam.framework.ui.command.ExecCommand.fireActionPerformed(ExecCommand.java:119)
	at org.esa.beam.framework.ui.command.SelectableCommand$1.actionPerformed(SelectableCommand.java:150)
	.......................
-------------------------------------------------------------------------------------

deadlock while opening an image view:
   open image view
   create pin(s)
   on the 'Pixel Info' select 'Snap to selected PIN'
   open an other image again and again
   --> VISAT freezes. Any Exception will not be shot.

-------------------------------------------------------------------------------------

The VISAT World Map: missing Help button

-------------------------------------------------------------------------------------


new mosaic processor
====================

- has no menu and therefore it is not possible to work with the request files
-----------------------------------------------------------------

-UTM proj. problem:
add some products (distributed on the world) to product list
select area: west long = 5, east long. = 20, north lat. = 65, south lat.= 50
select UTM, North, zone 32

output product: north lat.:	0°00'02" N, south lat.:	15°23'04" S  !!!!!
Map CRS:
PROJCS["UTM Zone 32 / World Geodetic System 1984",
  GEOGCS["World Geodetic System 1984",
    DATUM["World Geodetic System 1984",
      SPHEROID["WGS 84", 6378137.0, 298.257223563, AUTHORITY["EPSG","7030"]],
      AUTHORITY["EPSG","6326"]],
    PRIMEM["Greenwich", 0.0, AUTHORITY["EPSG","8901"]],
    UNIT["degree", 0.017453292519943295],
    AXIS["Geodetic longitude", EAST],
    AXIS["Geodetic latitude", NORTH]],
  PROJECTION["Transverse_Mercator"],
  PARAMETER["central_meridian", 9.0],
  PARAMETER["latitude_of_origin", 0.0],
  PARAMETER["scale_factor", 0.9996],
  PARAMETER["false_easting", 500000.0],
  PARAMETER["false_northing", 0.0],
-----------------------------------------------------------------------------
(IS_ALREADY_FIXED, mz, 2010-01-27)
- select/deselect 'Update target product' checkBox causes IllegalArgumentException

a) select: open product in VISAT - open mosaic - check in 'Update target product' --> the name of target product will be change to open in VISAT data automatically -->
beam-debug: AbstractProductReader.close(): org.esa.beam.dataio.envisat.EnvisatProductReader[input=C:\Projects\Testing\testdata\in\MERIS\MER_RR__1_test
.N1]
org.esa.beam.framework.gpf.OperatorException: Product has no metadata element named 'Processing_Graph'
        at org.esa.beam.gpf.common.mosaic.MosaicOp.getOperatorParameters(MosaicOp.java:486)
        at org.esa.beam.gpf.common.mosaic.ui.MosaicIOPanel$2.selectionChanged(MosaicIOPanel.java:106)
        at com.bc.ceres.swing.selection.support.SelectionChangeSupport.fireSelectionChange(SelectionChangeSupport.java:56)
        at com.bc.ceres.swing.selection.support.SelectionChangeSupport.fireSelectionChange(SelectionChangeSupport.java:51)
        at com.bc.ceres.swing.selection.AbstractSelectionContext.fireSelectionChange(AbstractSelectionContext.java:81)
        at com.bc.ceres.swing.selection.support.ComboBoxSelectionContext.access$100(ComboBoxSelectionContext.java:15)
        at com.bc.ceres.swing.selection.support.ComboBoxSelectionContext$ComboBoxSelectionHandler.itemStateChanged(ComboBoxSelectionContext.java:56)

------------------------------------------------------------------------------------------------------------------------------

- missing CRS information
------------------------------------------------------------------------------------------------------------------------------




//////////////////////////////////////////////////////////////////////////////////////
// TODO put in Wiki

h2. API changes:

h3. Product Data Model Changes
* Introduced Mask class
* Introduced VectorDataNode class
* Product class
** Added new methods to Product class
**# ProductNodeGroup<VectorData> getVectorDataGroup()
**# ProductNodeGroup<Mask> getMaskGroup()
** Deprecated a lot of old methods deling with {{BitRaster}} and bitmasks in general
** Change events for the following "properties" are not fired anymore: modified, owner 
* Added new methods to ProductVisitor interface:
*# void visit(Mask mask)
*# void visit(VectorDataNode dataNode)
* ProductNode class
** Rename updateExpression(s1, s2) to handleRename(node, s1, s2)  (TODO!)

h3. Ceres Binding API Changes

* Terminology changes followed by extensive renamings:
** ValueModel --> Property
** ValueDescriptor --> PropertyDescriptor
** ValueContainer --> PropertyContainer
** ValueAccessor --> PropertyAccessor
** ClassFieldDescriptorFactory --> PropertyDescriptorFactory
** ValueDescriptor.properties --> PropertyDescriptor.attributes (incl. all accessors)
* New interface PropertyAccessorFactory
* PropertyContainer.setValue(String propertyName, Object value) now throws IllegalArgumentException
 by wrapping a previously thrown ValidationException.

* PropertySet is an interface which has been extracted from PropertyContainer.
  Thus, in many places (including public BEAM API) the use of PropertyContainer has been replaced by PropertySet

* ValueEditor --> PropertyEditor
* ValueEditorRegistry --> PropertyEditorRegistry
* ValueEditorsPane --> PropertyPane


h3. Ceres Layer API Changes

* Renamed method LayerType.getConfigurationTemplate() to  createLayerConfig()
* Moved methods LayerType.createDefaultValueModel() ValueModel.createValueModel()

h3. Ceres Core API Changes
* Renamed class ServiceRegistryFactory to ServiceRegistryManager
